# Version 0.5
# Date : 20/05/2020
# Auteur : Romaric Béraud
# Ce script a pour but de rechercher des mots clés dans des fichiers (exemple : logs)

# Importe le module glob
import glob
# Importe le module os
import os
# Importe le module json
import json                                                 

# Demande à l'utilisateur le nom du fichier JSON
fichier_json = raw_input("Tapez le nom du fichier JSON : ")
# Demande à l'utilisateur le mot clé à rechercher
mot_cle = raw_input("Quel mot rechercher ? : ")

# Ouverture du fichier JSON contenant les noms des répertoires
with open(fichier_json) as fichier_config:
# Récupération du contenu sous forme de liste dans la variable liste_repertoire
  liste_repertoire = json.load(fichier_config)
# Pour chaque répertoire présent dans liste_repertoire :
  for repertoire in liste_repertoire:
# On se déplace dans le répertoire
    os.chdir(repertoire)
# Pour chaque fichier présent dans le répertoire :
    for fichier in glob.glob("*"):
# Si le fichier est bien un fichier (pas un répertoire) :
      if os.path.isfile(fichier):
# Ouverture du fichier
        with open(fichier, "r") as fichier_ouvert:
# Boucle lisant les lignes du fichier une par une
          for ligne in fichier_ouvert.readlines():
# Si le mot clé recherché est présent :
            if mot_cle in ligne:
# On affiche la ligne correspondante
              print(ligne)                                  
