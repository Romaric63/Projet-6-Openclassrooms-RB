# Version 0.5
# Date : 20/05/2020
# Auteur : Romaric Béraud
# Ce script a pour but de rechercher des mots clés dans des fichiers (exemple : logs)

import glob                                                 # Importe le module glob
import os                                                   # Importe le module os
import json                                                 # Importe le module json

fichier_json = raw_input("Tapez le nom du fichier JSON : ") # Demande à l'utilisateur le nom du fichier JSON
mot_cle = raw_input("Quel mot rechercher ? : ")             # Demande à l'utilisateur le mot clé à rechercher

with open(fichier_json) as fichier_config:                  # Ouverture du fichier JSON contenant les noms des répertoires
  liste_repertoire = json.load(fichier_config)              # Récupération du contenu sous forme de liste dans la variable liste_repertoire
  for repertoire in liste_repertoire:                       # Pour chaque répertoire présent dans liste_repertoire :
    os.chdir(repertoire)                                    # On se déplace dans le répertoire
    for fichier in glob.glob("*"):                          # Pour chaque fichier présent dans le répertoire :
      if os.path.isfile(fichier):                           # Si le fichier est bien un fichier (pas un répertoire) :
        with open(fichier, "r") as fichier_ouvert:          # Ouverture du fichier
          for ligne in fichier_ouvert.readlines():          # Boucle lisant les lignes du fichier une par une
            if mot_cle in ligne:
              print(ligne)                                  # Si le mot clé recherché est présent, la ligne est affichée
